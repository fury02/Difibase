import Blob "mo:base/Blob";
import Hex "mo:encoding/Hex";
import Text "mo:base/Text";

import SHA224 "../src/SHA/SHA224";

let sum224 = SHA224.sum(Blob.toArray(Text.encodeUtf8("hello world\n")));
assert(Hex.encode(sum224) == "95041DD60AB08C0BF5636D50BE85FE9790300F39EB84602858A9B430");

for (v in [
    ("", "D14A028C2A3A2BC9476102BB288234C415A2B01F828EA62AC5B3E42F"),
    ("a", "ABD37534C7D9A2EFB9465DE931CD7055FFDB8879563AE98078D6D6D5"),
    ("ab", "DB3CDA86D4429A1D39C148989566B38F7BDA0156296BD364BA2F878B"),
    ("abc", "23097D223405D8228642A477BDA255B32AADBCE4BDA0B3F7E36C9DA7"),
    ("abcd", "A76654D8E3550E9A2D67A0EEB6C67B220E5885EDDD3FDE135806E601"),
    ("abcde", "BDD03D560993E675516BA5A50638B6531AC2AC3D5847C61916CFCED6"),
    ("abcdef", "7043631CB415556A275A4EBECB802C74EE9F6153908E1792A90B6A98"),
    ("abcdefg", "D1884E711701AD81ABE0C77A3B0EA12E19BA9AF64077286C72FC602D"),
    ("abcdefgh", "17EB7D40F0356F8598E89EAFAD5F6C759B1F822975D9C9B737C8A517"),
    ("abcdefghi", "AEB35915346C584DB820D2DE7AF3929FFAFEF9222A9BCB26516C7334"),
    ("abcdefghij", "D35E1E5AF29DDB0D7E154357DF4AD9842AFEE527C689EE547F753188"),
].vals()) {
    assert(Hex.encode(SHA224.sum(Blob.toArray(Text.encodeUtf8(v.0)))) == v.1);
};
